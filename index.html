<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TicTacToe Deluxe â€” Multiplayer (Fixed Real-time Updates)</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
</head>
<body>
    <header>
        <h1>ðŸŽ® TicTacToe Deluxe â€” Multiplayer (Fixed Real-time)</h1>
        <div class="controls">
            <select id="mode">
                <option value="friend">Local Friend</option>
                <option value="easy">Robot (Easy)</option>
                <option value="hard">Robot (Hard)</option>
                <option value="multi">Multiplayer</option>
            </select>
            <select id="bestOf">
                <option value="1">Single Round</option>
                <option value="3">Best of 3</option>
                <option value="5" selected>Best of 5</option>
            </select>
            <button id="themeBtn">Toggle Theme</button>
        </div>
    </header>

    <main>
        <div class="card">
            <div class="game-info">
                <div class="info-item">
                    <div class="muted">Mode:</div>
                    <div id="modeLabel">Local Friend</div>
                </div>
                <div class="info-item">
                    <div class="muted">Turn:</div>
                    <div id="turnLabel">X</div>
                </div>
                <div class="info-item">
                    <div class="muted">You are:</div>
                    <div id="playerLabel">â€”</div>
                </div>
            </div>

            <div id="statusMessage" class="status-message"></div>

            <div id="board">
                <!-- Cells will be generated by JavaScript -->
            </div>

            <div class="tab-container">
                <div class="tab active" data-tab="create">Create/Join</div>
                <div class="tab tab-with-notification" data-tab="browse" id="browseTabButton">
                    Browse Rooms
                    <div class="notification-badge" id="notificationBadge" style="display: none;">0</div>
                </div>
            </div>

            <div class="tab-content active" id="createTab">
                <div class="game-controls">
                    <button id="createBtn" class="primary">Create Room</button>
                    <input id="roomInput" placeholder="Paste room code">
                    <button id="joinBtn">Join Room</button>
                </div>

                <div class="connection-status">
                    <div class="status-dot" id="connectionDot"></div>
                    <div id="connectionStatus">Not connected to a room</div>
                </div>

                <div class="player-list" id="playerList"></div>

                <div id="roomFullMessage" class="room-full" style="display: none;">Room is full - no more players can join</div>

                <div id="linkBox">No active room</div>
                <div style="margin-top: 10px;">
                    <button id="copyLink" disabled>Copy Link</button>
                    <button id="deleteRoomBtn" class="danger" style="display: none;">Delete Room</button>
                </div>
            </div>

            <div class="tab-content" id="browseTab">
                <h3>Available Rooms</h3>
                <div class="room-list" id="roomList">
                    <div class="loader"></div>
                </div>
                <div class="pagination">
                    <button id="prevPageBtn" disabled>Previous</button>
                    <span id="pageInfo">Page 1</span>
                    <button id="nextPageBtn">Next</button>
                </div>
            </div>

            <div class="auto-reset-container">
                <span>Auto Reset:</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="autoReset">
                    <span class="slider"></span>
                </label>
            </div>

            <div class="reset-container">
                <button id="resetBtn">Reset Game</button>
            </div>

            <div id="log"></div>
        </div>

        <div class="card">
            <h2>Score Board</h2>

            <div class="score-board">
                <div class="score-item">
                    <div>Player X</div>
                    <div id="scoreX" class="score-value">0</div>
                </div>
                <div class="score-item">
                    <div>Player O</div>
                    <div id="scoreO" class="score-value">0</div>
                </div>
                <div class="score-item">
                    <div>Rounds</div>
                    <div id="rounds" class="score-value">0/5</div>
                </div>
            </div>

            <div id="matchWinner" class="match-winner" style="display: none;"></div>

            <hr>

            <h2>Multiplayer</h2>
            <div class="muted">Share this link with your friend:</div>

            <hr>

            <h2>How to Play</h2>
            <div class="muted">
                <p>1. Create a room or join with a code</p>
                <p>2. Share the link with your friend</p>
                <p>3. Take turns placing X and O</p>
                <p>4. First to get 3 in a row wins the round</p>
                <p>5. First to win majority of rounds wins the match</p>
            </div>
        </div>
    </main>

    <!-- Custom Alert Box -->
    <div class="overlay" id="overlay"></div>
    <div class="custom-alert" id="customAlert">
        <div class="custom-alert-content" id="alertMessage"></div>
        <div>
            <button class="custom-alert-btn" id="alertButtonOk">OK</button>
            <button class="custom-alert-btn danger" id="alertButtonCancel" style="display: none;">Cancel</button>
        </div>
    </div>

    <!-- Join Request Alert -->
    <div class="custom-alert" id="joinRequestAlert">
        <div class="custom-alert-content" id="joinRequestMessage"></div>
        <div>
            <button class="custom-alert-btn primary" id="acceptRequestBtn">Accept</button>
            <button class="custom-alert-btn danger" id="rejectRequestBtn">Reject</button>
        </div>
    </div>

<!-- ... aapka baaki HTML code ... -->

    <!-- Create Room Modal -->
    <div class="modal" id="createRoomModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create a New Room</h2>
                <span class="close-btn" id="closeCreateModal">&times;</span>
            </div>
            <div class="modal-body">
                <input type="text" id="roomNameInput" placeholder="Enter Room Name" maxlength="25">
                <input type="password" id="roomPasswordInput" placeholder="Set a Password (optional)">
                <button id="createRoomSubmitBtn" class="primary">Create and Join</button>
            </div>
        </div>
    </div>

    <!-- Password Prompt Modal -->
    <div class="modal" id="passwordModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Enter Password</h2>
                <span class="close-btn" id="closePasswordModal">&times;</span>
            </div>
            <div class="modal-body">
                <p>This room is private. Please enter the password to join.</p>
                <input type="password" id="passwordPromptInput" placeholder="Room Password">
                <button id="passwordSubmitBtn" class="primary">Join Room</button>
                <div id="passwordError" class="status-message status-error" style="display: none;"></div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>